<!DOCTYPE html>
<html>
<head>
  <title>Heatmap Example</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
</head>
<body>

  <div id="map" style="height: 100vh;"></div>

  <div id="crime-type-selector">
    <input type="radio" name="crime-type" value="all" checked>All
    <input type="radio" name="crime-type" value="burglary">Burglary
    <input type="radio" name="crime-type" value="theft">Theft
    <input type="radio" name="crime-type" value="assault">Assault
    <input type="radio" name="crime-type" value="vandalism">Vandalism
    <input type="radio" name="crime-type" value="drug">Drug
  </div>

  <script>
    var map = L.map('map').setView([34.05, -118.24], 10);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
      maxZoom: 18
    }).addTo(map);

    $.get('data.csv', function(csvString) {
      var data = Papa.parse(csvString, {header: false, dynamicTyping: true}).data;

      var heatMapData = data.map(function(row) {
        return [row[0], row[1], row[2]];
      });

      var heat = L.heatLayer(heatMapData, {
        radius: 25,
        blur: 15,
        maxZoom: 18,
        max: 100
      }).addTo(map);

      $('input[name="crime-type"]').change(function() {
        var crimeType = $(this).val();
        if (crimeType === 'all') {
          heat.setLatLngs(heatMapData);
        } else {
          var filteredData = heatMapData.filter(function(row) {
            return row[2] === crimeType;
          });
          heat.setLatLngs(filteredData);
        }
      });
    });
  </script>

</body>
</html>